<?php// Start PHP session at the beginningsession_start();header('Content-Type: text/html; charset=utf-8');ini_set("default_charset", "UTF-8");mb_internal_encoding("UTF-8");iconv_set_encoding("internal_encoding", "UTF-8");iconv_set_encoding("output_encoding", "UTF-8");if (isset($_SESSION["email"])) {    $user = $_SESSION["email"];}if (isset($_GET["user"])) {    $user = $_GET["user"];}// Create database connection using config fileinclude_once("db-config.php");?><!DOCTYPE html><HTML><HEAD>    <meta name="viewport" content="width=device-width, initial-scale=1.0">    <link rel="icon" type="image/png" href="favicon.png">    <TITLE>Indian Motorcycle Rally - Cambiar Contraseña</TITLE></HEAD><BODY><?php include("menu.php"); ?><div class="rallybg">    <br/>    <DIV class="container my-4 py-4 bg-primary text-white" style="max-width:600px;">        <?php        // Check If form submitted, insert user data into database.        if (isset($_POST['changepass'])) {            $user = $_POST['disabledemail'];            $password = $_POST['password'];            $passwordbis = $_POST['passwordbis'];            $cryptpass = md5($password);            // If passwords don't match, throw error            if ($password != $passwordbis) {                echo "<div class='bg-primary text-white py-4'><h3><center><strong>Error: </strong> las contraseñas no coinciden.</center></h3></div>";            } else {                // Insert user data into database                $mysqli->set_charset("utf8");                $result = mysqli_query($mysqli, "UPDATE `rally_users` SET `password` = '$cryptpass' WHERE `rally_users`.`email` = '$user'");                // check if user data inserted successfully.                if ($result) {                    // On redirige vers la page d'envoi du mail de bienvenue                    session_destroy();                    echo "<div class='bg-primary text-white py-4'><center><h3>Tu contraseña ha sido cambiada, por favor entra de nuevo.</center></h3></div>";                } else {                    echo "<div class='bg-primary text-white py-4'><center><h3>Se ha producido un error. Por favor, inténtelo más tarde.</center></h3>" . mysqli_error($mysqli) . "</div>";                }            }        }        ?>        <H4 class="py-2">CAMBIAR TU CONTRASEÑA</H4>        <FORM action="changepass.php" method="post" name="changepass" class="needs-validation">            <LABEL for="disabledemail" class="form-label">Email : <?php echo $user; ?></LABEL>            <INPUT type="hidden" class="form-control" id="disabledemail" name="disabledemail"                   value="<?php echo $user; ?>">            <br>            <LABEL for="password" class="form-label">Contraseña</LABEL>            <INPUT type="password" class="form-control" id="password" name="password" required/>            <LABEL for="passwordbis" class="form-label">Repetir contraseña</LABEL>            <INPUT type="password" class="form-control" id="passwordbis" name="passwordbis" required/>            <CENTER>                <INPUT type="submit" id="changepass" name="changepass" class="btn btn-light btn-lg my-4"                       value="VALIDAR"/>            </CENTER>        </FORM>    </DIV>    <br></div><?php include("footer.php"); ?></BODY></HTML>